{"version":3,"sources":["../../src/__tests__/DELETE.test.js"],"names":["test","require","Moysklad","t","ms","internalorder","POST","organization","meta","type","href","buildUrl","positions","assortment","quantity","expand","equal","rows","length","id","map","pos","DELETE"],"mappings":"AAAA;;;;AAEA,MAAMA,OAAOC,QAAQ,WAAR,CAAb;AACA,MAAMC,WAAWD,QAAQ,IAAR,CAAjB;;AAEAD,KAAK,iBAAL;AAAA,+BAAwB,WAAMG,CAAN,EAAW;AACjC,QAAIC,KAAKF,UAAT;;AAEA,QAAIG,aAAJ;;AAEA,QAAI;AACFA,sBAAgB,MAAMD,GAAGE,IAAH,CAAQ,sBAAR,EAAgC;AACpDC,sBAAc;AACZC,gBAAM;AACJC,kBAAM,cADF;AAEJC,kBAAMN,GAAGO,QAAH,CAAY,0DAAZ;AAFF;AADM,SADsC;AAOpDC,mBAAW,CACT;AACEC,sBAAY;AACVL,kBAAM;AACJC,oBAAM,SADF;AAEJC,oBAAMN,GAAGO,QAAH,CAAY,CAAC,qDAAD,CAAZ;AAFF;AADI,WADd;AAOEG,oBAAU;AAPZ,SADS,EAUT;AACED,sBAAY;AACVL,kBAAM;AACJC,oBAAM,SADF;AAEJC,oBAAMN,GAAGO,QAAH,CAAY,CAAC,qDAAD,CAAZ;AAFF;AADI,WADd;AAOEG,oBAAU;AAPZ,SAVS;AAPyC,OAAhC,EA2BnB,EAAEC,QAAQ,WAAV,EA3BmB,CAAtB;;AA6BAZ,QAAEa,KAAF,CAAQX,cAAcO,SAAd,CAAwBK,IAAxB,CAA6BC,MAArC,EAA6C,CAA7C,EAAgD,sCAAhD;;AAEA,YAAMd,GAAGE,IAAH,CAAQ,CAAC,sBAAD,EAAyBD,cAAcc,EAAvC,EAA2C,kBAA3C,CAAR,EACJd,cAAcO,SAAd,CAAwBK,IAAxB,CAA6BG,GAA7B,CAAiC;AAAA,eAAQ,EAAEZ,MAAMa,IAAIb,IAAZ,EAAR;AAAA,OAAjC,CADI,CAAN;AAED,KAlCD,SAkCU;AACR,UAAIH,aAAJ,EAAmB,MAAMD,GAAGkB,MAAH,CAAUjB,cAAcG,IAAd,CAAmBE,IAA7B,CAAN;AACpB;AACF,GA1CD;;AAAA;AAAA;AAAA;AAAA","file":"DELETE.test.js","sourcesContent":["'use strict'\n\nconst test = require('blue-tape')\nconst Moysklad = require('..')\n\ntest('Moysklad#DELETE', async t => {\n  let ms = Moysklad()\n\n  let internalorder\n\n  try {\n    internalorder = await ms.POST('entity/internalorder', {\n      organization: {\n        meta: {\n          type: 'organization',\n          href: ms.buildUrl('entity/organization/bf6bc7ce-444e-4fd2-9826-3134ce89c54b')\n        }\n      },\n      positions: [\n        {\n          assortment: {\n            meta: {\n              type: 'product',\n              href: ms.buildUrl(['entity/product/d29f9d08-30d1-11e7-7a34-5acf004eda99'])\n            }\n          },\n          quantity: 1\n        },\n        {\n          assortment: {\n            meta: {\n              type: 'product',\n              href: ms.buildUrl(['entity/product/d29f038e-30d1-11e7-7a34-5acf004eda8c'])\n            }\n          },\n          quantity: 1\n        }\n      ]\n    }, { expand: 'positions' })\n\n    t.equal(internalorder.positions.rows.length, 2, 'should create order with 2 positions')\n\n    await ms.POST(['entity/internalorder', internalorder.id, 'positions/delete'],\n      internalorder.positions.rows.map(pos => ({ meta: pos.meta })))\n  } finally {\n    if (internalorder) await ms.DELETE(internalorder.meta.href)\n  }\n})\n"]}